
library(readr)
df <- read_csv("billioinare_stats.csv")

str(df)


df$rank <- as.character(df$rank)



na_per_column <- colSums(is.na(df))
print(na_per_column)





df$name_in_org <- mapply(function(org, first, last) {
  grepl(first, org) | grepl(last, org)
}, df$organization, df$firstName, df$lastName)

df$name_in_org <- mapply(function(org, first, last) {
  grepl(first, org, ignore.case = TRUE) | grepl(last, org, ignore.case = TRUE)
}, df$organization, df$firstName, df$lastName)

print(df)

library(dplyr)
library(lubridate)

df$birthDate <- as.Date(df$birthDate)

df <- df %>%
  mutate(age = ifelse(is.na(age), 
                      as.numeric(format(Sys.Date(), "%Y")) - birthYear, 
                      age))


na_per_column <- colSums(is.na(df))
print(na_per_column)


install.packages("ggplot2")
install.packages("ineq") 

library(ggplot2)
library(ineq) 





wealth_stats <- summary(df$finalWorth)
print(wealth_stats)


gini_coefficient <- ineq::Gini(df$finalWorth)
print(paste("Gini Coefficient:", gini_coefficient))

ggplot(df, aes(x = finalWorth)) +
  geom_histogram(binwidth = 1000, fill = "blue", color = "black") +
  scale_x_continuous(labels = scales::comma) +
  labs(x = "Wealth (in U.S. dollars)", y = "Count of Billionaires", title = "Distribution of Billionaire Wealth")


ggplot(df, aes(x = finalWorth)) +
  geom_density(fill = "blue", alpha = 0.5) +
  scale_x_continuous(labels = scales::comma) +
  labs(x = "Wealth (in U.S. dollars)", y = "Density", title = "Density of Billionaire Wealth")

count_by_category <- df %>%
  group_by(selfMade) %>%
  summarise(Count = n())

print(count_by_category)

average_wealth <- df %>%
  group_by(selfMade) %>%
  summarise(AverageWealth = mean(finalWorth, na.rm = TRUE))

print(average_wealth)


ggplot(df, aes(x = finalWorth, fill = selfMade)) +
  geom_histogram(position = "dodge", binwidth = 1000) +
  scale_x_continuous(labels = scales::comma) +
  labs(x = "Wealth (in U.S. dollars)", y = "Count", title = "Wealth Distribution: Self-Made vs. Inherited") +
  theme_minimal()

```


ggplot(df, aes(x = selfMade, y = finalWorth)) +
  geom_boxplot() +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "", y = "Wealth (in U.S. dollars)", title = "Wealth Comparison: Self-Made vs. Inherited") +
  theme_minimal()



